# Making ALSV5 - Free Project Ready - Game Animation Sample Layering (20240701)

hello everyone welcome back to the channel so what was promised last week is due I'm really happy to show you guys the game animation sample with the aist layering I've been working on this uh over the weekends since the game animation sample came out so in this video I'm going to walk you guys through what I've done show you guys the result and also as promised the project is on GitHub it is available for all of you and towards the end of the video I'm going to discuss some issues and some

rough edges that are still there and if anyone wants to participate to the GitHub project you guys can make poll requests and we can work on this to make it as good as possible so first of all we have all the ALS layers that are in here so all of them are working some of them are not blending perfectly because I did not spend too much time uh on the um like the specific curves and the blend of each bone but like most of the

are here and they work so that's nice um so it's as I said still using the curve system from uh from ALS so we can actually choose in the animation sequences how much we want to blend each thing um the aim offsets are also working so there is a a small issue with aim offsets in Crouch so Crouch animations for now don't have the um the turn in

place so this is why you will see like aim off sets in Crouch acting a little bit weird but other than that everything is working fine and when the guys at Epic uh ship the um 5.5 with Crouch and Sprint everything should be working fine so everything is here uh leftand items rightand items ik all of that stuff is working of course if you go over obstacles and

stuff with a barrel it's going to act a little bit weird but yeah this is it uh we can finally use the game animation sample to make some good action games good weapons and items the same way we were able to use uh ALS before all right so let me show you guys how I've done this explain to you a little bit the project and then uh we're going to get into some discussion

points so uh in the project all of the um layering system is in this folder here overlay system so and of course there is the uh the main character blueprint which has modifications as well and we're going to start with that so in the uh main character blueprint all the parts that that I've added you will see them in purple like this so basically the most important parts are

these uh the rest is really there to like clean up the system and have everything work and we're going to go over this step by step so let's start so in here we have this linked layer which is the overlay post and basically what this is is we have some uh an animation blueprint layer an animation layer interface which is here that has this animation layer and then

we have uh different an in Blueprint that implement this interface and that basically return a post so uh we have the default one which basically just returns um the uh local space ref pose and then we have a simple one which uh I use for basically overlays that only have like stenes like standing up uh and crouching idle and moving and then we have a more complex one which is um the one that we use for the weapons

so it has the relaxed ready and aiming States and inside each of these we have the different poses for walking uh running sprinting all of that so basically in the animation blueprint first of first thing is we get the overlay post depending on what uh linked layer is linked to to the mesh and I'm going I'm going to show this in the character blueprint a little bit later so once we have this we have this linked anim graph which is the uh does the

blending so this is in here also in the overlay system this is a separate anim graph and basically it is responsible for doing all the blending the same way ALS was doing it before it's it has this function in here which is uh reading the curve values and then it's the window blending in the graph um here the base posst I am basically like using the stance of the character so is he crouching or standing to get the Base Post uh when we will have uh transition

animations for Crouch so when we have like stand to crouch and Crouch to stand we're not going to need this reference we're going to use the curve directly which is the curve of the base POS so when we are going to be crouching that curve is going to go from uh zero to one for these and or one to zero for uh the way so this does the blending basically you can go through these there are a lot of videos that explain how this blending is done and once we have the motion

matching and we have the overlay pose we blend these two together and then we keep on going so basically H in here we get to the aim offset and for the aim offset if we are using a pose so like if I go into the game so you will see that when I'm not using an anim layer like the head is turning around uh and even when I'm using an anim layer the head is turning around but if I aim the head is not turning around because the entire character is turning around so the way

this is done is in um the alss poses there is this curve which is enable spine rotation which basically rotates the entire character uh when we are aiming so if I have these pose it means that I am playing an Aiming animation so I'm not playing the uh standard default offset for for the character if not then I playing this this one so this is what this is doing and this is doing the spine rotation after this we basically play

the uh the slot montages so these are the traversal montages so if I go here it's these montages and the thing is when we have for example a pistol and I play this let me put the game into slowmo so I will play this the the hand needs to stay in this position so when I play the Montage like you see that the hand still has the the overlay layer on top and this is what we're doing here so

basically after I play the Montage I reapply just on the hand uh right I reapply the um overlay po so these are things that were here before and here we do iave so basically it's the same way around so if I have in my uh animation poses the enable hand I right or left I do hand I so this is same way as it was done in um ALS and I don't apply ik if I

am uh playing a montage so if I'm vaulting or climbing um or mantling I don't play the uh I don't do the ik at all and that's it for for the um sandbox character so they're basically basically just with these we are playing the overlays and then the rest in here is for the aim offet uh and for the reapplying on the right hand and then the in the hand I so now we can go to the blueprint and

show you guys what we have here so basically in the blueprint here I have this overlay graph which is basically just has some debu commands to display the overlay switcher so the Q button and the mouse wheel up and down this is what uh allows you to uh switch these so I uh imported the overlay switcher widget uh from ALS and basically that's it so these are the changes that we have in here uh in

the blueprint uh we have this um in the event graph the only thing that we have is I've added this part here which basically updates the um held object check animation uh and yeah of course like I have the uh functions to attach things to the hand so basically whenever we update the overlay state from the switcher I come into this function here and uh I clear the object that we have in hand and then I apply the new link layer this is the this is what actually

switches the layers so each of these layer basically like if we go for example into the this is the rifle one so if I open these one this is a child of the uh ABP overlay base and basically what it does it just def defines the poses in here so you don't have to do this you don't have to uh like have a child of this any uh if you make an animation blueprint that is for this skeleton and you just like Implement in the class settings you implement this um interface

uh which is not going to be in the child but in here so you implement this um uh interface and then return a POS in here it's going to work when you link it and the way the way to link it is just by doing this call I just made these base classes so that it's easier we don't have to copy paste uh these things in in for all the items for all the overlays so I just made these base classes and then we can just inherit from them and we can put the um the poses directly in

the in the details in here uh in the class deports yeah so uh some uh things that I run into uh the first and most annoying one is when I uh ported the poses so if I go for example to um let's say let's take this one for example stand ready so when I ported these when I uh retargeted them the weapon right uh

bone did not retarget correctly so this is this is an annoying thing that happened I'm not sure exactly um why it didn't but so you see normally in ALS you just attach this to the Bone and like it looks it looks perfect so it did not retarget these I did not have time to re retarget everything so what I did is I just created uh different uh sockets for the different items so and I added um I added those

sockets directly in here in the attach method so I give the socket name this is kind of a workaround uh I would have preferred to have the weapon R be like in the poses be correctly set up so that we don't have to do this and we don't have to have a bunch of um sockets but if uh anyone knows why uh like that weapon R um so bone is not retargeted properly if anyone wants to fix it on the GitHub project please submit a pull request I will be very happy to accept it so yeah um everything

is here uh like I said you can play with the project uh it's on GitHub um I'm going to um keep working on this uh from time to time I'm going to try to solve these issues um but other than that yeah it's it's really nice it it works we can use um like the an game animation sample now with some weapons Crouch is working everything is

working it behaves correctly so yeah go make some cool games so that's it I hope you guys uh like it um I hope you guys are going to play with it and I hope you guys you'll help me maintain the GitHub project and do some nice pull requests and get this to uh a state where we can actually consider it as an ALS V5 thanks a lot guys and uh have fun see you later
